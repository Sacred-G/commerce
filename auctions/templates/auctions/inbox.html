{% extends "auctions/layout.html" %}
{% block body %}
<div class="container">
    <h2>Inbox</h2>
    <a href="{% url 'send_message' %}" class="btn btn-primary mb-3">Compose Message</a>
    
    <h3>Received Messages</h3>
    {% if messages %}
        <ul class="list-group">
        {% for message in messages %}
            <li class="list-group-item {% if not message.read %}font-weight-bold{% endif %}">
                <a href="{% url 'view_message' message.id %}">
                    {% if message.is_system_message %}
                        <span class="text-success">System:</span>
                    {% elif message.sender %}
                        {{ message.sender.username }}:
                    {% else %}
                        Unknown:
                    {% endif %}
                    {{ message.subject }}
                </a>
                <small class="text-muted float-right">{{ message.created_at|date:"M d, Y H:i" }}</small>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No messages in your inbox.</p>
    {% endif %}

    <h3 class="mt-4">Sent Messages</h3>
    {% if sent_messages %}
        <ul class="list-group">
        {% for message in sent_messages %}
            <li class="list-group-item">
                <a href="{% url 'view_message' message.id %}">
                    To: {{ message.recipient.username }} - {{ message.subject }}
                </a>
                <small class="text-muted float-right">{{ message.created_at|date:"M d, Y H:i" }}</small>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No sent messages.</p>
    {% endif %}
</div>
{% endblock %}